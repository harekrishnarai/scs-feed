name: Flowlyt manual scan

on:
  workflow_dispatch: {}

permissions:
  contents: read
  security-events: write

jobs:
  analyze:
    name: Flowlyt security scan
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run Flowlyt Security Scan
        uses: harekrishnarai/flowlyt@f9c1041af4ffe2a45adbe374c8d9d40fb07d3d6d
        with:
          # don't pass config-file or enable-ast-analysis (these are not required / invalid)
          repository: .
          output-format: sarif
          output-file: flowlyt-results.sarif
          min-severity: LOW
          fail-on-severity: CRITICAL
          max-critical: 0
          max-high: 0
          comment-on-pr: true
          upload-sarif: 'true'
          sarif-category: flowlyt
          create-issue: 'false'
          config-file: ''
          issue-labels: security,flowlyt
          continue-on-error: 'false'
          verbose: 'false'
      - name: Upload SARIF to GitHub Security
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: flowlyt-results.sarif
